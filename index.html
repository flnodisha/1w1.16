<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PNG PDF Viewer</title>

  <!-- Font Awesome for download icon -->
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f0f0;
    }
    .viewer-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    .viewer-container img {
      width: 100%;
      max-width: 800px;
      margin-bottom: 20px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      border-radius: 8px;
    }

    /* Floating rounded download button */
    #downloadBtn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      background-color: #007BFF;
      color: white;
      border: none;
      border-radius: 50%;
      font-size: 24px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      z-index: 9999;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #downloadBtn:hover {
      background-color: #0056b3;
    }

    #downloadBtn::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 70px;
      right: 0;
      background: #333;
      color: #fff;
      padding: 6px 10px;
      font-size: 12px;
      border-radius: 5px;
      opacity: 0;
      white-space: nowrap;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    #downloadBtn:hover::after {
      opacity: 1;
    }
  </style>
</head>
<body>

  <div class="viewer-container" id="book-pages">
    <!-- Replace with your actual PNG/WebP images -->
    <img src="page2.webp" alt="Page 2">
    <img src="page3.webp" alt="Page 3">
    <img src="page4.webp" alt="Page 4">
    <img src="page1.webp" alt="Page 1">
    <!-- Add more images if needed -->
  </div>

  <!-- Floating download button -->
  <button id="downloadBtn" onclick="generatePDF()" data-tooltip="Download PDF">
    <i class="fas fa-download"></i>
  </button>

  <!-- jsPDF for PDF generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    async function generatePDF() {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF();
      const images = document.querySelectorAll('#book-pages img');

      for (let i = 0; i < images.length; i++) {
        const img = images[i];

        // Wait until image is fully loaded
        if (!img.complete) await new Promise(resolve => img.onload = resolve);

        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = img.naturalWidth;
        canvas.height = img.naturalHeight;
        ctx.drawImage(img, 0, 0);

        const imgData = canvas.toDataURL('image/jpeg');

        if (i > 0) pdf.addPage();
        pdf.addImage(imgData, 'JPEG', 0, 0, 210, 297); // Fit to A4

        canvas.remove();
      }

      pdf.save('my-book.pdf');
    }
  </script>

</body>
</html>
